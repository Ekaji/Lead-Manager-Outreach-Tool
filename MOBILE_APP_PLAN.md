# Mobile App Implementation Plan: Lead Manager & Outreach Tool

## 1. Project Overview

**Goal**: Build a React Native mobile application to import leads via CSV (from the Chrome Extension), manage them, and streamline outreach using customizable WhatsApp and Email templates.

**Target Platform**: iOS & Android (via Expo).

## 2. Tech Stack Recommendations

- **Framework**: [Expo](https://expo.dev/) (Managed Workflow) - For rapid development and easy deployment.
- **Language**: TypeScript
- **UI Component Library**: React Native Paper or Tamagui (for consistent, nice-looking UI matching the dashboard).
- **Navigation**: React Navigation (Stack + Bottom Tabs).
- **State Management**: Zustand (lightweight) or React Context.
- **Data Persistence**:
  - `SQLite` (via `expo-sqlite`): _Recommended_ for storing Leads AND Templates. Using SQLite for everything allows complex queries and unified backup strategies.
  - `AsyncStorage`: Use only for simple user preferences (e.g., theme, default sorting).
- **CSV Handling**: `expo-document-picker` (to select file) + `papaparse` (to parse content).
- **Linking**: `Linking` API (core React Native) to open WhatsApp and Email apps.

## 3. Core Features

### A. Lead Import

- **Feature**: Import CSV file generated by the Google Lead Scraper extension.
- **Workflow**:
  1. User transfers CSV to phone (iCloud/Drive/Download).
  2. Tap "Import Leads" in App -> Opens Document Picker.
  3. App parses CSV headers (mapping fields like Name, Phone, Website).

  **CSV Structure (Headers)**:
  - `Business Name` (String)
  - `Category` (String)
  - `Location` (String)
  - `Phone` (String)
  - `Website` (String)
  - `Rating` (Number)
  - `Reviews` (Number)
  - `Priority` (High/Medium/Low)
  - `Status` (New/Contacted/etc.)
  - `Contacted Date` (Date string)
  - `Response Date` (Date string)
  - `Notes` (String)
  - `Tags` (String, semicolon separated)
  - `Deal Value` (String)
  - `Next Follow Up` (Date string)
  - `Has Website` (Yes/No)
  - `Extracted At` (ISO Date string)
  4. **Preview & Deduplication**:
     - Show a summary modal: "Found 150 leads. 20 are duplicates."
     - Strategy: Check generic duplicates by `Phone` or `Business Name`.
     - Option to "Skip Duplicates" or "Update Existing".
  5. Saves valid leads to local database with metadata (Source: "CSV Import", Created_At).

### B. Lead Management (Dashboard)

- **Grid/List View**: Display leads with badges for Status (New, Contacted, Won).
- **Search & Filter**: Filter by "Priority", "Status", or "Tags".
- **Quick Actions**: Swipe right to "Mark as Contacted".

### C. Outreach Templates

- **Feature**: Create dynamic message templates.
- **Variables**: Support placeholders like `{name}`, `{business_name}`, `{location}`.
- **CRUD**: Create, Read, Update, Delete templates for:
  - WhatsApp Messages
  - Emails (Subject + Body)

### D. Action Execution

- **WhatsApp Button**:
  - Opens modal to select a Template.
  - Pre-fills message with Lead's data.
  - Opens WhatsApp app with the message ready to send.
- **Email Button**:
  - Opens modal to select Template.
  - Opens default Mail app with Subject/Body pre-filled.

## 4. App Structure (Navigation)

### Bottom Tab Navigator

1.  **Leads** (Home)
    - _Stack_: LeadList -> LeadDetails
2.  **Templates**
    - _Stack_: TemplateList -> EditTemplate
3.  **Settings**
    - **Backup/Restore**:
      - Export SQLite DB to a generic JSON file.
      - Import JSON to restore data (useful when switching phones).

## 5. Detailed Step-by-Step Implementation

### Phase 1: Setup & Navigation

- Initialize Expo project with TypeScript.
- Set up React Navigation (Tabs).
- Configure UI Library (e.g., React Native Paper).

### Phase 2: Data Layer (SQLite)

- Create `database.ts` service.
- Define Tables:
  - `Leads` (id, name, phone, email, status, priority, rating, reviews, ... + `created_at`, `source`)
  - `Templates` (id, type, subject, content, `created_at`)
- Implement `addLead` (with duplicate check), `getLeads`, `updateLeadStatus`.

### Phase 3: Templates System

- UI for adding/editing templates.
- Logic to replace `{placeholders}` with actual string values.

### Phase 4: Import Functionality

- Implement Document Picker.
- Map CSV columns to Database columns.
- Handle duplicates (optional: check by Phone/Name).

### Phase 5: Outreach & Linking

- Implement `Linking.openURL()` logic.
  - **Phone Normalization**: Ensure numbers have country code (e.g., +234) and strip special characters before sending.
  - **URL Encoding**: Use `encodeURIComponent` for message bodies to handle special characters/emojis correctly.
  - WhatsApp: `whatsapp://send?phone=...&text=...`
  - Email: `mailto:...?subject=...&body=...`
- Auto-update Lead Status to "Contacted" after action.

## 6. UI Mockup Concepts

- **Home**: Clean list, floating "Import" button.
- **Details**: Card-style layout (similar to Web Dashboard). large action buttons for Call/Message.
- **Template Editor**: Text area with helper chips for `{name}`, `{business}` variables.

## 7. Next Steps

1.  Initialize Project: `npx create-expo-app@latest mobile-app`
